<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Dengue Forecasting Project</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Dengue Forecasting Project">
  <meta name="generator" content="bookdown 0.1.9 and GitBook 2.6.7">

  <meta property="og:title" content="Dengue Forecasting Project" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Dengue Forecasting Project" />
  
  
  

<meta name="author" content="Raghvendra Jain">


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-prediction-starts-here.html">
<link rel="next" href="introduction.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="hypothesis.html"><a href="hypothesis.html"><i class="fa fa-check"></i><b>2</b> Hypothesis</a></li>
<li class="chapter" data-level="3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-description-of-variables"><i class="fa fa-check"></i><b>3.1</b> The description of variables</a></li>
<li class="chapter" data-level="3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-diurnal-temperature-range-dtr"><i class="fa fa-check"></i><b>3.2</b> The diurnal temperature range (DTR)</a></li>
<li class="chapter" data-level="3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-average-monthly-rainfall-in-bangkok."><i class="fa fa-check"></i><b>3.3</b> The average monthly rainfall in Bangkok.</a></li>
<li class="chapter" data-level="3.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-dengue-incidences-in-bangkok-districts"><i class="fa fa-check"></i><b>3.4</b> The dengue incidences in Bangkok Districts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-prediction-starts-here.html"><a href="the-prediction-starts-here.html"><i class="fa fa-check"></i><b>4</b> The Prediction Starts here</a></li>
<li class="chapter" data-level="5" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html"><i class="fa fa-check"></i><b>5</b> Time Series Analysis in R</a><ul>
<li class="chapter" data-level="5.1" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#exponential-smoothing"><i class="fa fa-check"></i><b>5.1</b> Exponential Smoothing</a></li>
<li class="chapter" data-level="5.2" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#seasonal-arima-model"><i class="fa fa-check"></i><b>5.2</b> Seasonal ARIMA Model</a></li>
<li class="chapter" data-level="5.3" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#a-bayesian-structural-time-series-model"><i class="fa fa-check"></i><b>5.3</b> A Bayesian Structural Time Series Model</a></li>
<li class="chapter" data-level="5.4" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#a-structured-bayesian-network-approach"><i class="fa fa-check"></i><b>5.4</b> A Structured Bayesian Network Approach</a></li>
<li class="chapter" data-level="5.5" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#generalized-additive-model"><i class="fa fa-check"></i><b>5.5</b> Generalized Additive Model</a></li>
<li class="chapter" data-level="5.6" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#study-area-1"><i class="fa fa-check"></i><b>5.6</b> Study Area 1</a></li>
<li class="chapter" data-level="5.7" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#prediction-using-the-entire-data-with-gam"><i class="fa fa-check"></i><b>5.7</b> Prediction using the entire data with GAM</a></li>
<li class="chapter" data-level="5.8" data-path="time-series-analysis-in-r.html"><a href="time-series-analysis-in-r.html#notes-to-myself"><i class="fa fa-check"></i><b>5.8</b> Notes to myself:</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>6</b> Introduction</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction.html"><a href="introduction.html#including-plots"><i class="fa fa-check"></i><b>6.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="another-intro.html"><a href="another-intro.html"><i class="fa fa-check"></i><b>7</b> Another Intro</a><ul>
<li class="chapter" data-level="7.1" data-path="another-intro.html"><a href="another-intro.html#including-plots-1"><i class="fa fa-check"></i><b>7.1</b> Including Plots</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Dengue Forecasting Project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-analysis-in-r" class="section level1">
<h1><span class="header-section-number">5</span> Time Series Analysis in R</h1>
<p>First, let’s plot the data</p>
<p><img src="_main_files/figure-html/plotData-1.png" width="672" /></p>
<p>We can see from this time series that there seems to be seasonal variation in the number of dengue incidences per month: there is a peak every winter, and a trough every summer. Again, it seems that this time series could probably be described using an additive model, as the seasonal fluctuations are roughly constant in size over time and do not seem to depend on the level of the time series, and the random fluctuations also seem to be roughly constant in size over time.</p>
<p>Thus, we don’t need to tranform the time series by calculating the natural log of the original data.</p>
<div id="exponential-smoothing" class="section level2">
<h2><span class="header-section-number">5.1</span> Exponential Smoothing</h2>
<p><img src="_main_files/figure-html/ets-1.png" width="672" /></p>
</div>
<div id="seasonal-arima-model" class="section level2">
<h2><span class="header-section-number">5.2</span> Seasonal ARIMA Model</h2>
<p>When a model is fit by manual setting of parameters.</p>
<p>I fit an ARIMA(0,1,1)(0,1,1)[12] model.</p>
<p><img src="_main_files/figure-html/ARIMA_DHF-1.png" width="672" /></p>
<p>I fit an ARIMA(1,0,3)(1,1,1)[12] model.</p>
<p><img src="_main_files/figure-html/autoArima-1.png" width="672" /></p>
</div>
<div id="a-bayesian-structural-time-series-model" class="section level2">
<h2><span class="header-section-number">5.3</span> A Bayesian Structural Time Series Model</h2>
<p><img src="_main_files/figure-html/bsts-1.png" width="672" /><img src="_main_files/figure-html/bsts-2.png" width="672" /></p>
</div>
<div id="a-structured-bayesian-network-approach" class="section level2">
<h2><span class="header-section-number">5.4</span> A Structured Bayesian Network Approach</h2>
<p><img src="_main_files/figure-html/HybridBayesianNet-1.png" width="672" /></p>
<pre><code>                ME    RMSE      MAE       MPE     MAPE
Test set -1.063421 10.0441 6.664085 -60.43833 79.39199</code></pre>
<p><img src="_main_files/figure-html/newBN-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">accuracy</span>(<span class="dt">f =</span> pred, <span class="dt">x =</span>  bayesianDF.test[, <span class="st">&quot;count&quot;</span>])</code></pre></div>
<pre><code>               ME     RMSE      MAE      MPE     MAPE
Test set 8.765601 27.51189 16.08321 -87.3934 135.7163</code></pre>
</div>
<div id="generalized-additive-model" class="section level2">
<h2><span class="header-section-number">5.5</span> Generalized Additive Model</h2>
<p>Now, I analyse the dataset according using the Generalized Additive Model.</p>
<p>The dataset consists of following entries:</p>
<ol style="list-style-type: decimal">
<li>Information of each district
<ul>
<li>identification codes</li>
<li>name of the district.</li>
<li>population (divided into various age bins)</li>
<li>area in square kms.</li>
<li>Number of communities</li>
<li>number of neighboring districts</li>
</ul></li>
<li>Monthly DHF count in each district from 2008~2015</li>
<li>Monthly average rainfall in Bangkok from 2008~2015</li>
<li>Monthly Diurnal Temperature Range (DTR) in Bangkok from 2008~2015</li>
</ol>
<p>The map of Bangkok is shown below.</p>
<p><img src="_main_files/figure-html/BKKImage-1.png" width="672" /></p>
<p>There are 18 districts that are close to stream as shown in the above map. Their names are:</p>
<pre><code> [1] &quot;Bang Su&quot;         &quot;Dusit&quot;           &quot;Bang Plad&quot;      
 [4] &quot;Phra Nakhon&quot;     &quot;Bangkok Noi&quot;     &quot;Bangkok Yai&quot;    
 [7] &quot;Thon Buri&quot;       &quot;Khlong San&quot;      &quot;Pom Pram Sattru&quot;
[10] &quot;Samphantawong&quot;   &quot;Bang Rak&quot;        &quot;Sathorn&quot;        
[13] &quot;Bang Kho Laem&quot;   &quot;Yannawa&quot;         &quot;Rat Burana&quot;     
[16] &quot;Khlong Toey&quot;     &quot;Prakanong&quot;       &quot;Bang Na&quot;        </code></pre>
</div>
<div id="study-area-1" class="section level2">
<h2><span class="header-section-number">5.6</span> Study Area 1</h2>
<p>For the ease of experimentation, I use the data from first district (indexed as 1 in the image of Bangkok) and perform the our analyses. The name of the district is Phra Nakhon. As you can see, it is located near the stream.</p>
<p><img src="_main_files/figure-html/Data_1001-1.png" width="672" /><img src="_main_files/figure-html/Data_1001-2.png" width="672" /><img src="_main_files/figure-html/Data_1001-3.png" width="672" /><img src="_main_files/figure-html/Data_1001-4.png" width="672" /><img src="_main_files/figure-html/Data_1001-5.png" width="672" /><img src="_main_files/figure-html/Data_1001-6.png" width="672" /><img src="_main_files/figure-html/Data_1001-7.png" width="672" /></p>
<p><img src="_main_files/figure-html/optimal_Model-1.png" width="672" /><img src="_main_files/figure-html/optimal_Model-2.png" width="672" /><img src="_main_files/figure-html/optimal_Model-3.png" width="672" /><img src="_main_files/figure-html/optimal_Model-4.png" width="672" /></p>
<p><img src="_main_files/figure-html/testing-1.png" width="672" /></p>
</div>
<div id="prediction-using-the-entire-data-with-gam" class="section level2">
<h2><span class="header-section-number">5.7</span> Prediction using the entire data with GAM</h2>
</div>
<div id="notes-to-myself" class="section level2">
<h2><span class="header-section-number">5.8</span> Notes to myself:</h2>
<ul>
<li>I need to create the lagged values for each district.</li>
<li>Separate the data into training and testing datasets. Keep the year variable flexible, so that I can experiment with year variables</li>
<li>Row bind all the training datasets i.e. the data from 50 BKK districts</li>
<li>Row bind all the data from the testing datasets similar to above.</li>
<li>make tests.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-prediction-starts-here.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
